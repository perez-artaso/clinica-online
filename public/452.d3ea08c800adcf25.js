"use strict";(self.webpackChunkclinica_online=self.webpackChunkclinica_online||[]).push([[452],{4452:(x,v,r)=>{r.r(v),r.d(v,{AppointmentModule:()=>Ut});var f=r(6895),C=r(2435),_=r(590);class u{constructor(o="",e=0,i="",s="",a="",c=0,g="",l="",d=0,m=""){this.id="",this.timestamp=o,this.duration=e,this.idPatient=i,this.idSpecialist=s,this.speciality=a,this.specialistCommentary=g,this.patientComentary=l,this.calification=c,this.status=d,this.id=m}getLiteralObjectRepresentation(){return{timestamp:this.timestamp,duration:this.duration,idPatient:this.idPatient,idSpecialist:this.idSpecialist,speciality:this.speciality,specialistCommentary:this.specialistCommentary,patientComentary:this.patientComentary,calification:this.calification,status:this.status}}getStatusAsString(){switch(this.status){case 0:return"Solicitado";case 1:case 5:return"Cancelado";case 2:return"Rechazado";case 3:return"Aceptado";case 4:return"Realizado";default:return"Desconocido"}}static parseArrayOfLiteralObjectsToInstances(o){let e=[];return o.forEach(i=>e.push(new u(i.timestamp,i.duration,i.idPatient,i.idSpecialist,i.speciality,i.calification,i.specialistCommentary,i.patientComentary,i.status,i.id))),e}}var h=r(7101),t=r(4650),p=r(7556),A=r(9181),P=r(3422),b=r(2963),w=r(349),Z=r(4471);function O(n,o){if(1&n&&(t.TgZ(0,"h4"),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.patientProfile.name+" "+e.patientProfile.last_name)}}function k(n,o){if(1&n&&(t.TgZ(0,"h4"),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.specialistProfile.name+" "+e.specialistProfile.last_name)}}function D(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onActionSelected("readSpecialistCommentary"))}),t._UZ(1,"i",6),t.qZA()}}function M(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onActionSelected("calification"))}),t._UZ(1,"i",17),t.qZA()}}function N(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onActionSelected("fillSurvey"))}),t._UZ(1,"i",19),t.qZA()}}function I(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onActionSelected("cancelationByPatient"))}),t._UZ(1,"i",21),t.qZA()}}function F(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onActionSelected("acceptanceBySpecialist"))}),t._UZ(1,"i",23),t.qZA()}}function J(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onActionSelected("cancelationBySpecialist"))}),t._UZ(1,"i",21),t.qZA()}}function B(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onActionSelected("rejectionBySpecialist"))}),t._UZ(1,"i",25),t.qZA()}}function U(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onActionSelected("finalization"))}),t._UZ(1,"i",27),t.qZA()}}function q(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onActionSelected("calificationView"))}),t._UZ(1,"i",17),t.qZA()}}function E(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onActionSelected("cancelationByAdmin"))}),t._UZ(1,"i",21),t.qZA()}}let L=(()=>{class n{constructor(e,i){this.profileService=e,this.dates=i,this.appointment=new u,this.userProfile=new h.N,this.patientProfile=new h.N,this.specialistProfile=new h.N,this.cardClasses=[],this.dateManager=new Date(Number(this.appointment.timestamp)),this.actionEmitter=new t.vpe}ngOnInit(){this.profileService.getProfileByUID(this.appointment.idPatient).pipe((0,_.P)()).subscribe(e=>{this.patientProfile=e[0]}),this.profileService.getProfileByUID(this.appointment.idSpecialist).pipe((0,_.P)()).subscribe(e=>{this.specialistProfile=e[0]})}ngOnChanges(e){e.appointment.currentValue!=e.appointment.previousValue&&(this.dateManager=new Date(Number(e.appointment.currentValue.timestamp)),this.appointment=e.appointment.currentValue),e.userProfile.currentValue!=e.userProfile.previousValue&&(this.userProfile=e.userProfile.currentValue)}setClassesByStatus(e){switch(e){case 0:return"alert-info";case 1:case 2:case 5:return"alert-danger";case 3:case 4:return"alert-success";default:return""}}onActionSelected(e){this.actionEmitter.emit({action:e,appointment:this.appointment})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A.H),t.Y36(b.R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-appointment-card"]],inputs:{appointment:"appointment",userProfile:"userProfile"},outputs:{actionEmitter:"actionRequest"},features:[t.TTD],decls:26,vars:18,consts:[[1,"card-container"],[1,"alert","appointment-card-header",3,"ngClass"],[1,"alert",3,"ngClass"],[4,"ngIf"],[1,"appointment-options"],["title","Hidden, only for keeping uniform spacing",1,"appointment-option",2,"visibility","hidden"],[1,"bi","bi-chat"],["class","appointment-option","title","Comentarios",3,"click",4,"ngIf"],["class","appointment-option","title","Calificar",3,"click",4,"ngIf"],["class","appointment-option","title","Encuesta",3,"click",4,"ngIf"],["class","appointment-option","title","Cancelar",3,"click",4,"ngIf"],["class","appointment-option","title","Aceptar",3,"click",4,"ngIf"],["class","appointment-option","title","Rechazar",3,"click",4,"ngIf"],["class","appointment-option","title","Finalizar",3,"click",4,"ngIf"],["class","appointment-option","title","Ver Rese\xf1a",3,"click",4,"ngIf"],["title","Comentarios",1,"appointment-option",3,"click"],["title","Calificar",1,"appointment-option",3,"click"],[1,"bi","bi-star-half"],["title","Encuesta",1,"appointment-option",3,"click"],[1,"bi","bi-ui-checks"],["title","Cancelar",1,"appointment-option",3,"click"],[1,"bi","bi-x-lg"],["title","Aceptar",1,"appointment-option",3,"click"],[1,"bi","bi-check-lg"],["title","Rechazar",1,"appointment-option",3,"click"],[1,"bi","bi-trash"],["title","Finalizar",1,"appointment-option",3,"click"],[1,"bi","bi-check2-all"],["title","Ver Rese\xf1a",1,"appointment-option",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"p",1),t._uU(2),t.qZA(),t.TgZ(3,"div",2),t.YNc(4,O,2,1,"h4",3),t.YNc(5,k,2,1,"h4",3),t.TgZ(6,"h5"),t._uU(7),t.qZA(),t.TgZ(8,"ul")(9,"li"),t._uU(10),t.qZA(),t.TgZ(11,"li"),t._uU(12),t.qZA()(),t.TgZ(13,"div",4)(14,"button",5),t._UZ(15,"i",6),t.qZA(),t.YNc(16,D,2,0,"button",7),t.YNc(17,M,2,0,"button",8),t.YNc(18,N,2,0,"button",9),t.YNc(19,I,2,0,"button",10),t.YNc(20,F,2,0,"button",11),t.YNc(21,J,2,0,"button",10),t.YNc(22,B,2,0,"button",12),t.YNc(23,U,2,0,"button",13),t.YNc(24,q,2,0,"button",14),t.YNc(25,E,2,0,"button",10),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("ngClass",i.setClassesByStatus(i.appointment.status)),t.xp6(1),t.Oqu(i.appointment.getStatusAsString()),t.xp6(1),t.Q6J("ngClass",i.setClassesByStatus(i.appointment.status)),t.xp6(1),t.Q6J("ngIf",1==i.userProfile.role),t.xp6(1),t.Q6J("ngIf",0==i.userProfile.role),t.xp6(2),t.Oqu(i.appointment.speciality),t.xp6(3),t.hij(" ",i.dates.getLocaleDateStringByTimestamp(i.appointment.timestamp)," "),t.xp6(2),t.hij(" ",i.dates.getLocaleTimeStringByTimestamp(i.appointment.timestamp)," "),t.xp6(4),t.Q6J("ngIf",0==i.userProfile.role&&""!=i.appointment.specialistCommentary),t.xp6(1),t.Q6J("ngIf",0==i.userProfile.role&&4==i.appointment.status&&0==i.appointment.calification),t.xp6(1),t.Q6J("ngIf",0==i.userProfile.role&&4==i.appointment.status&&""!=i.appointment.specialistCommentary),t.xp6(1),t.Q6J("ngIf",0==i.userProfile.role&&(0==i.appointment.status||3==i.appointment.status)),t.xp6(1),t.Q6J("ngIf",1==i.userProfile.role&&0==i.appointment.status),t.xp6(1),t.Q6J("ngIf",1==i.userProfile.role&&0==i.appointment.status),t.xp6(1),t.Q6J("ngIf",1==i.userProfile.role&&0==i.appointment.status),t.xp6(1),t.Q6J("ngIf",1==i.userProfile.role&&3==i.appointment.status),t.xp6(1),t.Q6J("ngIf",1==i.userProfile.role&&""!=i.appointment.patientComentary),t.xp6(1),t.Q6J("ngIf",2==i.userProfile.role&&0==i.appointment.status))},dependencies:[f.mk,f.O5],styles:["#appointment-cards-container[_ngcontent-%COMP%]{width:100%;margin:1rem;display:flex;gap:1rem;flex-wrap:wrap}h4[_ngcontent-%COMP%]{font-weight:bolder}.appointment-card-header[_ngcontent-%COMP%]{margin:0;padding:.2rem;max-width:33%;border-radius:0}.appointment-options[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:.5rem}.appointment-option[_ngcontent-%COMP%]{border-radius:5px}"]}),n})();function Y(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-appointment-card",9),t.NdJ("actionRequest",function(s){t.CHM(e);const a=t.oxw();return t.KtG(a.onActionRequested(s))}),t.qZA()}if(2&n){const e=o.$implicit,i=t.oxw();t.Q6J("appointment",e)("userProfile",i.userProfile)}}function Q(n,o){1&n&&(t.TgZ(0,"h2",17),t._uU(1,"Indique los motivos de su cancelaci\xf3n"),t.qZA())}function H(n,o){1&n&&(t.TgZ(0,"h2",17),t._uU(1,"Indique los motivos de su rechazo"),t.qZA())}function R(n,o){1&n&&(t.TgZ(0,"h2",17),t._uU(1,"Resuma su diagn\xf3stico o comentarios afines"),t.qZA())}function K(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"div",11),t.YNc(2,Q,2,0,"h2",12),t.YNc(3,H,2,0,"h2",12),t.YNc(4,R,2,0,"h2",12),t.TgZ(5,"div",13)(6,"textarea",14),t.NdJ("change",function(s){t.CHM(e);const a=t.oxw();return t.KtG(a.setComment(s))}),t.qZA()(),t.TgZ(7,"div",15)(8,"button",16),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.cancelation(s.userProfile.role))}),t._uU(9," Cancelar Turno "),t.qZA()()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",1==e.selectedAppointment.status||5==e.selectedAppointment.status),t.xp6(1),t.Q6J("ngIf",2==e.selectedAppointment.status),t.xp6(1),t.Q6J("ngIf",4==e.selectedAppointment.status),t.xp6(4),t.Q6J("disabled",e.comment.length<6)}}function G(n,o){1&n&&t._UZ(0,"i",21)}function z(n,o){1&n&&t._UZ(0,"i",21)}function V(n,o){1&n&&t._UZ(0,"i",21)}function j(n,o){1&n&&t._UZ(0,"i",21)}const S=function(n){return{"calification-selected":n}},$=function(){return[1,2,3,4,5]},W=function(){return[1,2,3,4]},X=function(){return[1,2,3]},tt=function(){return[1,2]};function et(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"div",11)(2,"h2",17),t._uU(3,"\xbfC\xf3mo calificar\xeda la atenci\xf3n recibida?"),t.qZA(),t.TgZ(4,"div",18)(5,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.setCalification(5))}),t._uU(6," Excelente "),t._UZ(7,"br"),t.YNc(8,G,1,0,"i",20),t.qZA(),t.TgZ(9,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.setCalification(4))}),t._uU(10," Buena "),t._UZ(11,"br"),t.YNc(12,z,1,0,"i",20),t.qZA(),t.TgZ(13,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.setCalification(3))}),t._uU(14," Regular "),t._UZ(15,"br"),t.YNc(16,V,1,0,"i",20),t.qZA(),t.TgZ(17,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.setCalification(2))}),t._uU(18," Mala "),t._UZ(19,"br"),t.YNc(20,j,1,0,"i",20),t.qZA(),t.TgZ(21,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.setCalification(1))}),t._uU(22," Muy mala "),t._UZ(23,"br")(24,"i",21),t.qZA()(),t.TgZ(25,"h2",17),t._uU(26,"Deje una breve rese\xf1a sobre la atenci\xf3n recibida"),t.qZA(),t.TgZ(27,"div",13)(28,"textarea",14),t.NdJ("change",function(s){t.CHM(e);const a=t.oxw();return t.KtG(a.setComment(s))}),t.qZA()(),t.TgZ(29,"div",15)(30,"button",16),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.calificate())}),t._uU(31," Rese\xf1ar "),t.qZA()()()()}if(2&n){const e=t.oxw();t.xp6(5),t.Q6J("ngClass",t.VKq(10,S,5==e.selectedAppointment.calification)),t.xp6(3),t.Q6J("ngForOf",t.DdM(12,$)),t.xp6(1),t.Q6J("ngClass",t.VKq(13,S,4==e.selectedAppointment.calification)),t.xp6(3),t.Q6J("ngForOf",t.DdM(15,W)),t.xp6(1),t.Q6J("ngClass",t.VKq(16,S,3==e.selectedAppointment.calification)),t.xp6(3),t.Q6J("ngForOf",t.DdM(18,X)),t.xp6(1),t.Q6J("ngClass",t.VKq(19,S,2==e.selectedAppointment.calification)),t.xp6(3),t.Q6J("ngForOf",t.DdM(21,tt)),t.xp6(1),t.Q6J("ngClass",t.VKq(22,S,1==e.selectedAppointment.calification)),t.xp6(9),t.Q6J("disabled",e.comment.length<6||0==e.selectedAppointment.calification)}}function it(n,o){1&n&&(t.TgZ(0,"h2",17),t._uU(1,"Comentarios del especialista"),t.qZA())}function nt(n,o){1&n&&(t.TgZ(0,"h2",17),t._uU(1,"Rese\xf1a del paciente"),t.qZA())}function st(n,o){if(1&n&&(t.TgZ(0,"div",13)(1,"h4",25),t._uU(2),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(2),t.hij(' " ',e.selectedAppointment.specialistCommentary,' "')}}function ot(n,o){1&n&&t._UZ(0,"i",21)}function at(n,o){if(1&n&&(t.TgZ(0,"h3"),t._uU(1,"Calificaci\xf3n: "),t.YNc(2,ot,1,0,"i",20),t.qZA()),2&n){const e=t.oxw(3);t.xp6(2),t.Q6J("ngForOf",e.calificationArray)}}function ct(n,o){if(1&n&&(t.TgZ(0,"div",26),t.YNc(1,at,3,1,"h3",27),t.TgZ(2,"h4"),t._uU(3),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",0!=e.selectedAppointment.calification),t.xp6(2),t.hij(' " ',e.selectedAppointment.patientComentary,' "')}}function pt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"div",11),t.YNc(2,it,2,0,"h2",12),t.YNc(3,nt,2,0,"h2",12),t.YNc(4,st,3,1,"div",22),t.YNc(5,ct,4,2,"div",23),t.TgZ(6,"div",15)(7,"button",24),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.revealSpecialistComment=!1)}),t._uU(8," Cerrar "),t.qZA()()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",0==e.userProfile.role),t.xp6(1),t.Q6J("ngIf",1==e.userProfile.role),t.xp6(1),t.Q6J("ngIf",0==e.userProfile.role),t.xp6(1),t.Q6J("ngIf",1==e.userProfile.role)}}let rt=(()=>{class n{constructor(e,i,s,a,c,g,l){this.router=e,this.auth=i,this.profileService=s,this.clinicalRecordService=a,this.dates=c,this.appointmentService=g,this.loading=l,this.userProfile=new h.N,this.appointments=[],this.appointmentsBackup=[],this.clinicalRecords=[],this.profiles=[],this.revealCancelationMessageInput=!1,this.revealCalificationInput=!1,this.revealSpecialistComment=!1,this.selectedAppointment=new u,this.calificationArray=[],this.comment=""}ngOnInit(){this.userProfile=this.auth.GetCurrentUserProfile(),this.loadAppointments(),this.getProfiles()}getPatientsAppointments(e){this.appointmentService.getAppointmentsByPatientId(e).pipe((0,_.P)()).subscribe(i=>{this.appointments=u.parseArrayOfLiteralObjectsToInstances(i),this.appointmentsBackup=u.parseArrayOfLiteralObjectsToInstances(i)})}getSpecialistAppointments(e){this.appointmentService.getAppointmentsBySpecialistId(e).pipe((0,_.P)()).subscribe(i=>{this.appointments=u.parseArrayOfLiteralObjectsToInstances(i),this.appointmentsBackup=u.parseArrayOfLiteralObjectsToInstances(i)})}getAppointments(){this.appointmentService.getDocuments().subscribe(e=>{this.appointments=u.parseArrayOfLiteralObjectsToInstances(e),this.appointmentsBackup=u.parseArrayOfLiteralObjectsToInstances(e)})}getClinicalRecords(){this.clinicalRecordService.getDocuments().subscribe(e=>{this.clinicalRecords=e})}getProfiles(){this.profileService.getDocuments().subscribe(e=>{this.profiles=e})}loadAppointments(){switch(this.userProfile.role){case 0:this.getPatientsAppointments(this.userProfile.uid);break;case 1:this.getSpecialistAppointments(this.userProfile.uid),this.getClinicalRecords();break;case 2:this.getAppointments(),this.getClinicalRecords()}}filter(e){const i=new Date;if(""!=e.value){let s=[],a="",c="";const g=e.value.split(":");g.length>1&&isNaN(Number(g[0]))?(a=g[1],c=g[0]):a=e.value,(1==this.userProfile.role||2==this.userProfile.role)&&this.clinicalRecords.forEach(l=>{let d;for(d in l)""==c?l[d].toString().toLowerCase().includes(a.toLowerCase())&&this.appointmentsBackup.forEach(m=>{m.idPatient==l.uid&&(s.includes(m)||s.push(m))}):l[d].toString().toLowerCase().includes(a.toLowerCase())&&d.toLowerCase().includes(c.toLowerCase())&&this.appointmentsBackup.forEach(m=>{m.idPatient==l.uid&&(s.includes(m)||s.push(m))})}),this.profiles.forEach(l=>{let d;for(d in l)""==c?l[d].toString().toLowerCase().includes(a.toLowerCase())&&this.appointmentsBackup.forEach(m=>{(m.idPatient==l.uid&&(1==this.userProfile.role||2==this.userProfile.role)||m.idSpecialist==l.uid&&0==this.userProfile.role)&&(s.includes(m)||s.push(m))}):l[d].toString().toLowerCase().includes(a.toLowerCase())&&d.toLowerCase().includes(c.toLowerCase())&&this.appointmentsBackup.forEach(m=>{(m.idPatient==l.uid&&(1==this.userProfile.role||2==this.userProfile.role)||m.idSpecialist==l.uid&&0==this.userProfile.role)&&(s.includes(m)||s.push(m))})}),this.appointmentsBackup.forEach(l=>{let d;for(d in l)""==c?(l[d].toString().toLowerCase().includes(a.toLowerCase())||"timestamp"==d&&i.setTime(Number(l[d]))&&(i.toLocaleDateString().toLowerCase().includes(a.toLowerCase())||i.toLocaleTimeString().toLowerCase().includes(a.toLowerCase())))&&(s.includes(l)||s.push(l)):l[d].toString().toLowerCase().includes(a.toLowerCase())&&d.toLowerCase().includes(c.toLowerCase())&&(s.includes(l)||s.push(l))}),this.appointments=s}else this.appointments=this.appointmentsBackup}setComment(e){this.comment=e.target?.value}onActionRequested(e){switch(this.selectedAppointment=e.appointment,e.action){case"cancelationByPatient":this.selectedAppointment.status=5,this.revealCancelationMessageInput=!0;break;case"calification":this.revealCalificationInput=!0;break;case"readSpecialistCommentary":this.revealSpecialistComment=!0;break;case"cancelationBySpecialist":case"cancelationByAdmin":this.selectedAppointment.status=1,this.revealCancelationMessageInput=!0;break;case"rejectionBySpecialist":this.selectedAppointment.status=2,this.revealCancelationMessageInput=!0;break;case"acceptanceBySpecialist":this.acceptance();break;case"finalization":this.selectedAppointment.status=4,this.revealCancelationMessageInput=!0;break;case"calificationView":this.revealCalificationView()}}revealCalificationView(){for(let e=0;e<this.selectedAppointment.calification;e++)this.calificationArray.push(e);this.revealSpecialistComment=!0}acceptance(){this.selectedAppointment.status=3,this.loading.loadingStart(),this.appointmentService.updateDocument(this.selectedAppointment.id,this.selectedAppointment.getLiteralObjectRepresentation()).then(()=>{this.loading.loadingEnd()}).catch(()=>this.loading.loadingEnd())}cancelation(e){0==e?this.selectedAppointment.patientComentary=this.comment:1==e?this.selectedAppointment.specialistCommentary=this.comment:2==e&&(this.selectedAppointment.specialistCommentary="[Mensaje Del Administrador]: "+this.comment),this.loading.loadingStart(),this.appointmentService.updateDocument(this.selectedAppointment.id,this.selectedAppointment.getLiteralObjectRepresentation()).then(()=>{this.loading.loadingEnd()}).catch(()=>this.loading.loadingEnd()),this.revealCancelationMessageInput=!1,4==this.selectedAppointment.status&&this.router.navigate(["/clinical-record/state"],{queryParams:{uid:this.selectedAppointment.idPatient},replaceUrl:!0})}calificate(){this.selectedAppointment.patientComentary=this.comment,this.loading.loadingStart(),this.appointmentService.updateDocument(this.selectedAppointment.id,this.selectedAppointment.getLiteralObjectRepresentation()).then(()=>this.loading.loadingEnd()).catch(()=>this.loading.loadingEnd()),this.revealCalificationInput=!1}setCalification(e){this.selectedAppointment.calification=e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(C.F0),t.Y36(p.e),t.Y36(A.H),t.Y36(P.c),t.Y36(b.R),t.Y36(w.H),t.Y36(Z.b))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-panel"]],decls:13,vars:4,consts:[[1,"panel-container"],["id","title_and_filter"],["id","title"],["id","filter-input-container"],["id","filter-input","type","text",3,"keyup"],["filterInput",""],["id","appointment-cards-container"],[3,"appointment","userProfile","actionRequest",4,"ngFor","ngForOf"],["class","comment-full-screen-container",4,"ngIf"],[3,"appointment","userProfile","actionRequest"],[1,"comment-full-screen-container"],[1,"input-container"],["class","input-title",4,"ngIf"],[1,"form-group","px-5"],["rows","7",1,"form-control",3,"change"],[1,"btn-container"],[1,"btn","btn-lg","btn-block","smt-btn","my-3",3,"disabled","click"],[1,"input-title"],[1,"d-flex","justify-content-center","align-items-center","my-4"],[1,"btn","calification-btn",3,"ngClass","click"],["class","bi bi-star-fill",4,"ngFor","ngForOf"],[1,"bi","bi-star-fill"],["class","form-group px-5",4,"ngIf"],["style","color: white","class","form-group px-5",4,"ngIf"],[1,"btn","btn-lg","btn-block","smt-btn","my-3",3,"click"],[2,"color","white"],[1,"form-group","px-5",2,"color","white"],[4,"ngIf"]],template:function(e,i){if(1&e){const s=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),t._uU(3,"Turnos"),t.qZA(),t.TgZ(4,"div",3),t._uU(5," Filtro "),t.TgZ(6,"input",4,5),t.NdJ("keyup",function(){t.CHM(s);const c=t.MAs(7);return t.KtG(i.filter(c))}),t.qZA()()(),t.TgZ(8,"div",6),t.YNc(9,Y,1,2,"app-appointment-card",7),t.qZA()(),t.YNc(10,K,10,4,"div",8),t.YNc(11,et,32,24,"div",8),t.YNc(12,pt,9,4,"div",8)}2&e&&(t.xp6(9),t.Q6J("ngForOf",i.appointments),t.xp6(1),t.Q6J("ngIf",i.revealCancelationMessageInput),t.xp6(1),t.Q6J("ngIf",i.revealCalificationInput),t.xp6(1),t.Q6J("ngIf",i.revealSpecialistComment))},dependencies:[f.mk,f.sg,f.O5,L],styles:[".panel-container[_ngcontent-%COMP%]{width:95vw;border:var(--dark) solid 1px;margin-top:1rem;border-radius:1rem;margin:2rem auto}#title_and_filter[_ngcontent-%COMP%]{margin-top:1rem;margin-left:1rem;position:relative}#title[_ngcontent-%COMP%]{display:inline-block}#filter-input-container[_ngcontent-%COMP%]{display:inline-block;position:absolute;right:2rem;top:50%;transform:translateY(-50%);font-size:large;font-weight:700}#filter-input[_ngcontent-%COMP%]{border-radius:.5rem}#appointment-cards-container[_ngcontent-%COMP%]{width:100%;margin:1rem;display:flex;gap:1rem;flex-wrap:wrap}.card-container[_ngcontent-%COMP%]{width:30%!important}h4[_ngcontent-%COMP%]{font-weight:bolder}.appointment-card-header[_ngcontent-%COMP%]{margin:0;padding:.2rem;max-width:33%;border-radius:0}.appointment-options[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:.5rem}.appointment-option[_ngcontent-%COMP%]{border-radius:5px}app-appointment-card[_ngcontent-%COMP%]{width:30%!important}.comment-full-screen-container[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background-color:#38abab66}.input-container[_ngcontent-%COMP%]{width:50vw;border-radius:25px;background-color:var(--dark)}.btn-container[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:space-around}.smt-btn[_ngcontent-%COMP%]{background-color:#bd5353;width:60%;color:#fff}@media (max-width: 780px){.input-container[_ngcontent-%COMP%]{width:80vw}}.input-title[_ngcontent-%COMP%]{color:#fff;margin:1rem 0rem 1rem 1rem}.calification-btn[_ngcontent-%COMP%]{background-color:var(--light);color:#fff;margin-right:1rem}.calification-selected[_ngcontent-%COMP%]{border:1px solid white;padding:1rem}"]}),n})();var lt=r(3944);class y{constructor(o=0,e=0){this.elementOnScreen=o,this.containerSize=e}}var mt=r(9073),ut=r(3871);let dt=(()=>{class n{constructor(e){this.el=e,this.mms=new y}ngOnChanges(e){this.el.nativeElement.style.transform="translate(-"+e.mms.currentValue.containerSize*e.mms.currentValue.elementOnScreen+"vw)"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.SBq))},n.\u0275dir=t.lG2({type:n,selectors:[["","mms",""]],inputs:{mms:"mms"},features:[t.TTD]}),n})();var ft=r(3333),ht=r(2340),_t=r(4869),gt=r(8709),Ct=r(1481);function vt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",4),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.onSelectedSpecialist(a))}),t.TgZ(1,"p",5),t._uU(2),t.qZA(),t._UZ(3,"img",6),t.qZA()}if(2&n){const e=o.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(e.name+" "+e.last_name),t.xp6(1),t.Q6J("src",i.getSpecialistProfileImage(e.uid),t.LSH)}}function St(n,o){if(1&n&&(t.TgZ(0,"div",2),t.YNc(1,vt,4,2,"div",3),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.specialists)}}function At(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",8),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.selectSpecialityAndSubmit(a))}),t.TgZ(1,"p",9),t._uU(2),t.qZA(),t._UZ(3,"img",10),t.qZA()}if(2&n){const e=o.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(e),t.xp6(1),t.Q6J("src",i.getSpecialityImageURL(e),t.LSH)}}function bt(n,o){if(1&n&&(t.TgZ(0,"div",2),t.YNc(1,At,4,2,"div",7),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.specialitiesBySpecialist)}}let yt=(()=>{class n{constructor(e,i,s,a){this.profiles=e,this.specialityService=i,this.profileImages=s,this.sanitizer=a,this.showSpecialists=!0,this.showSpecialities=!1,this.specialists=[],this.specialities=[],this.selectedSpecialist=new ft.d,this.selectedSpeciality="",this.showSpecialistsBySpeciality=!1,this.showSpecialitiesBySpecialist=!1,this.specialitiesBySpecialist=[],this.specialistsBySpecialities=[],this.specialistEmitter=new t.vpe,this.systemSpecialities=[],this.specialistsImages=[]}ngOnInit(){this.profiles.getSpecialistsProfiles().subscribe(e=>{this.specialists=e,this.specialities=this.getSpecialityList(),this.getSpecialistsImages()}),this.specialityService.getDocuments().pipe((0,_.P)()).subscribe(e=>this.systemSpecialities=e)}getSpecialistsImages(){this.specialists.forEach(e=>{this.profileImages.getImagesByUID(e.uid).pipe((0,_.P)()).subscribe(i=>{i.length>0&&this.specialistsImages.push(i[0])})})}getSpecialistProfileImage(e){for(let i=0;i<this.specialistsImages.length;i++)if(this.specialistsImages[i].uid==e)return this.getSanitizedSrc(this.specialistsImages[i].images[0]);return this.getSanitizedSrc(ht.N.templateImg)}getSanitizedSrc(e){return this.sanitizer.bypassSecurityTrustResourceUrl("data:image/jpg;base64,"+e)}getSpecialityList(){let e=[];return this.specialists.forEach(i=>{i.specialities.forEach(s=>{this.isSpecialityAlreadyInList(e,s)||e.push(s)})}),e}isSpecialityAlreadyInList(e,i){for(let s=0;s<e.length;s++)if(e[s].toLowerCase()==i.toLowerCase())return!0;return!1}setSpecialitiesBySpecialist(e){this.specialitiesBySpecialist=e.specialities}setSpecialistBySpecialities(e){let i=[];for(let s=0;s<this.specialists.length;s++)-1!=this.specialists[s].specialities.indexOf(e)&&i.push(this.specialists[s]);this.specialistsBySpecialities=i}onSelectedSpecialist(e){this.setSelectedSpecialist(e),this.setSpecialitiesBySpecialist(e),this.specialitiesBySpecialist.length>1?this.revealSpecialitiesBySpecialist():(this.selectedSpeciality=this.specialitiesBySpecialist[0],this.emmitSpecialityAndSpecialist())}onSelectedSpeciality(e){this.setSelectedSpeciality(e),this.setSpecialistBySpecialities(e),this.revealSpecialistsBySpeciality()}setSelectedSpecialist(e){this.selectedSpecialist=e}setSelectedSpeciality(e){this.selectedSpeciality=e}selectSpecialityAndSubmit(e){this.setSelectedSpeciality(e),this.emmitSpecialityAndSpecialist()}selectSpecialistAndSubmit(e){this.setSelectedSpecialist(e),this.emmitSpecialityAndSpecialist()}emmitSpecialityAndSpecialist(){this.specialistEmitter.emit({specialist:this.selectedSpecialist,speciality:this.selectedSpeciality}),this.hideAll()}revealSpecialists(){this.showSpecialists=!0,this.showSpecialities=!1,this.showSpecialistsBySpeciality=!1,this.showSpecialitiesBySpecialist=!1}revealSpecialities(){this.showSpecialists=!1,this.showSpecialities=!0,this.showSpecialistsBySpeciality=!1,this.showSpecialitiesBySpecialist=!1}revealSpecialistsBySpeciality(){this.showSpecialists=!1,this.showSpecialities=!1,this.showSpecialistsBySpeciality=!0,this.showSpecialitiesBySpecialist=!1}revealSpecialitiesBySpecialist(){this.showSpecialists=!1,this.showSpecialities=!1,this.showSpecialistsBySpeciality=!1,this.showSpecialitiesBySpecialist=!0}hideAll(){this.showSpecialists=!0,this.showSpecialities=!1,this.showSpecialistsBySpeciality=!1,this.showSpecialitiesBySpecialist=!1}getSpecialityImageURL(e){let i="assets/speciality-images/",s=!1;for(let a=0;a<this.systemSpecialities.length;a++)if(this.systemSpecialities[a].name==e){i+=this.systemSpecialities[a].image+".png",s=!0;break}return s?i:i+"default.png"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A.H),t.Y36(_t.d),t.Y36(gt.x),t.Y36(Ct.H7))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-appointment-first-step"]],outputs:{specialistEmitter:"specialityAndSpecialist"},decls:3,vars:2,consts:[["id","first-step-container"],["class","row mt-5",4,"ngIf"],[1,"row","mt-5"],["class","alert alert-success col-3 me-4 specialist",3,"click",4,"ngFor","ngForOf"],[1,"alert","alert-success","col-3","me-4","specialist",3,"click"],[2,"font-weight","bold","font-size","large"],["alt","specialist-image",3,"src"],["class","alert alert-success col-3 me-2 speciality-container",3,"click",4,"ngFor","ngForOf"],[1,"alert","alert-success","col-3","me-2","speciality-container",3,"click"],[2,"font-weight","bold"],["alt","speciality-image",3,"src"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.YNc(1,St,2,1,"div",1),t.YNc(2,bt,2,1,"div",1),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",i.showSpecialists),t.xp6(1),t.Q6J("ngIf",i.showSpecialitiesBySpecialist))},dependencies:[f.sg,f.O5],styles:[".fs-option[_ngcontent-%COMP%]{background-color:var(--light);color:#fff}.alert[_ngcontent-%COMP%]:hover{cursor:pointer}.alert[_ngcontent-%COMP%]:active{transform:scale(.98)}.first-filter-container[_ngcontent-%COMP%]{border:solid 1px var(--dark);border-radius:5px;padding:1rem 0rem}.specialist[_ngcontent-%COMP%]{border-radius:100%;width:18rem;height:18rem}img[_ngcontent-%COMP%]{border-radius:100%;max-width:10rem}.speciality-container[_ngcontent-%COMP%]{width:18rem;height:18rem;margin-right:2rem}"]}),n})();class Tt{constructor(o=""){this.timestamp=o}}var wt=r(243);function xt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",4),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.onSelectedDay(a))}),t.TgZ(1,"h4",5),t._uU(2),t.qZA(),t.TgZ(3,"div"),t._uU(4),t.qZA()()}if(2&n){const e=o.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(i.dates.getInvertedLocaleDateStringByTimestamp(e.getTime().toString())),t.xp6(2),t.Oqu(i.dates.getDayOfTheWeekNameByTimestamp(e.getTime().toString()))}}function Pt(n,o){if(1&n&&(t.TgZ(0,"div",1)(1,"h2",2),t._uU(2,"Seleccione un d\xeda"),t.qZA(),t.YNc(3,xt,5,2,"div",3),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.possibleDays)}}function Zt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",4),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.emmitSelectedDate(a.timestamp))}),t.TgZ(1,"h4",5),t._uU(2),t.qZA()()}if(2&n){const e=o.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(i.dates.getLocaleTimeStringByTimestamp(e.timestamp))}}function Ot(n,o){if(1&n&&(t.TgZ(0,"div",1)(1,"h2",2),t._uU(2,"Seleccione un horario"),t.qZA(),t.YNc(3,Zt,3,1,"div",3),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.possibleTimes)}}let kt=(()=>{class n{constructor(e){this.dates=e,this.disponibilities=[],this.appointments=[],this.selectedDateEmitter=new t.vpe,this.appointmentOffers=[],this.possibleDays=[],this.possibleTimes=[],this.displayTimes=!1}ngAfterViewInit(){this.setPossibleDays()}setPossibleDays(){for(let e=0;e<this.disponibilities.length;e++)this.possibleDays.push(this.getNextWeeksDesiredDaysDate(1,this.disponibilities[e].day)),this.possibleDays.push(this.getNextWeeksDesiredDaysDate(2,this.disponibilities[e].day))}onSelectedDay(e){let i=new wt.k;console.log("entered on select day"),this.disponibilities.forEach(s=>{s.day==e.getDay()&&(i=s)}),0!=i.day&&(this.appointmentOffersTimestampBreakdown(e,i.from,i.to,30,this.possibleTimes),this.possibleTimes=this.GetFilteredAppointmentOffers(this.possibleTimes),this.displayTimes=!0)}GetFilteredAppointmentOffers(e){return this.appointments.forEach(i=>{e.forEach((s,a,c)=>{i.timestamp==s.timestamp&&(0==i.status||3==i.status)&&(e=c.slice(0,a).concat(c.slice(a+1)))})}),e}FilterAndDisplayOffers(){this.appointments.forEach(e=>{this.appointmentOffers.forEach((i,s,a)=>{e.timestamp==i.timestamp&&(0==e.status||3==e.status)&&(this.appointmentOffers=a.slice(0,s).concat(a.slice(s+1)))})})}GenerateAppointmentOffers(){for(let e=0;e<this.disponibilities.length;e++)this.appointmentOffersTimestampBreakdown(this.getNextWeeksDesiredDaysDate(1,this.disponibilities[e].day),this.disponibilities[e].from,this.disponibilities[e].to,30,this.appointmentOffers),this.appointmentOffersTimestampBreakdown(this.getNextWeeksDesiredDaysDate(2,this.disponibilities[e].day),this.disponibilities[e].from,this.disponibilities[e].to,30,this.appointmentOffers)}getNextWeeksDesiredDaysDate(e,i){const s=new Date;let a=new Date;return s.getDay()<i?a.setDate(s.getDate()+7*e-(s.getDay()-i+7)):a.setDate(s.getDate()+7*e-(7-(7-(s.getDay()-i)))),a}appointmentOffersTimestampBreakdown(e,i,s,a,c){let g=new Date(e),l=new Date(e),d=i.split(":"),m=s.split(":");g.setHours(Number(d[0]),Number(d[1]),0,0),l.setHours(Number(m[0]),Number(m[1]),0,0);for(let T=g.getTime();T<l.getTime();T+=6e4*a)c.push(new Tt(T.toString()))}emmitSelectedDate(e){this.selectedDateEmitter.emit(new Date(Number(e)))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(b.R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-appointment-offer"]],inputs:{disponibilities:"disponibilities",appointments:"appointments"},outputs:{selectedDateEmitter:"selectedDate"},decls:2,vars:2,consts:[["class","row mt-5",4,"ngIf"],[1,"row","mt-5"],[2,"margin-bottom","2rem"],["class","alert alert-success col-3 me-2",3,"click",4,"ngFor","ngForOf"],[1,"alert","alert-success","col-3","me-2",3,"click"],[2,"font-weight","bold"]],template:function(e,i){1&e&&(t.YNc(0,Pt,4,1,"div",0),t.YNc(1,Ot,4,1,"div",0)),2&e&&(t.Q6J("ngIf",!i.displayTimes),t.xp6(1),t.Q6J("ngIf",i.displayTimes))},dependencies:[f.sg,f.O5],styles:[".alert[_ngcontent-%COMP%]:hover{cursor:pointer}.alert[_ngcontent-%COMP%]:active{transform:scale(.98)}"]}),n})();function Dt(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",11),t._UZ(2,"i",12),t._uU(3," Su turno fue correctamente solicitado. "),t.qZA()())}function Mt(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",13),t._UZ(2,"i",14),t._uU(3," Ha ocurrido un error inesperado. Consulte con el administrador del sitio. "),t.qZA()())}let Nt=(()=>{class n{constructor(e,i,s){this.appointments=e,this.router=i,this.dates=s,this.appointment=new u,this.specialistFullName="",this.cancelationEmitter=new t.vpe,this.revealSuccessMessage=!1,this.revealErrorMessage=!1}onConfirmation(){this.appointments.addDocument(this.appointment.getLiteralObjectRepresentation()).then(()=>{this.revealSuccessMessage=!0,setTimeout(()=>this.router.navigate(["/appointments/panel"]),2e3)}).catch(()=>{this.revealErrorMessage=!0,setTimeout(()=>this.router.navigate(["/home"]),4e3)})}onCancelation(){this.cancelationEmitter.emit()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(w.H),t.Y36(C.F0),t.Y36(b.R))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-appointment-confirmation"]],inputs:{appointment:"appointment",specialistFullName:"specialistFullName"},outputs:{cancelationEmitter:"onCancelation"},decls:20,vars:6,consts:[[1,"row"],[1,"col-md-6",2,"margin","0 auto"],[1,"alert-success","alert","rounded"],[1,"alert","rounded",2,"background-color","var(--dark)","color","white"],[2,"font-weight","bold"],[1,"appointment-options"],["title","Confirmar",1,"appointment-option",3,"click"],[1,"bi","bi-check-lg"],["title","Cancelar",1,"appointment-option",3,"click"],[1,"bi","bi-x-lg"],["class","row",4,"ngIf"],[1,"alert","col-md-6",2,"background-color","rgb(130, 232, 130)","margin","0 auto","font-size","x-large"],[1,"bi","bi-check-circle-fill",2,"font-size","x-large"],[1,"alert","col-md-6",2,"background-color","rgb(230, 117, 117)","margin","0 auto","font-size","x-large"],[1,"bi","bi-x-circle-fill",2,"font-size","x-large"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t._uU(4,"Confirmaci\xf3n de turno"),t.qZA(),t.TgZ(5,"h3",4),t._uU(6),t.qZA(),t.TgZ(7,"h4"),t._uU(8),t.qZA(),t.TgZ(9,"h5"),t._uU(10),t.qZA(),t.TgZ(11,"h5"),t._uU(12),t.qZA(),t.TgZ(13,"div",5)(14,"button",6),t.NdJ("click",function(){return i.onConfirmation()}),t._UZ(15,"i",7),t.qZA(),t.TgZ(16,"button",8),t.NdJ("click",function(){return i.onCancelation()}),t._UZ(17,"i",9),t.qZA()()()()(),t.YNc(18,Dt,4,0,"div",10),t.YNc(19,Mt,4,0,"div",10)),2&e&&(t.xp6(6),t.Oqu(i.specialistFullName),t.xp6(2),t.Oqu(i.appointment.speciality),t.xp6(2),t.hij(" ",i.dates.getDayOfTheWeekNameByTimestamp(i.appointment.timestamp)+" "+i.dates.getLocaleDateStringByTimestamp(i.appointment.timestamp)," "),t.xp6(2),t.Oqu(i.dates.getLocaleTimeStringByTimestamp(i.appointment.timestamp)),t.xp6(6),t.Q6J("ngIf",i.revealSuccessMessage),t.xp6(1),t.Q6J("ngIf",i.revealErrorMessage))},dependencies:[f.O5],styles:[".appointment-options[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:.5rem}.appointment-option[_ngcontent-%COMP%]{border-radius:5px;font-size:x-large;padding:0 2rem}.appointment-option[_ngcontent-%COMP%]:active{transform:scale(.95)}"]}),n})();function It(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",10),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw();return c.newAppointment.idPatient=a.uid,t.KtG(c.move())}),t.TgZ(1,"p",11),t._uU(2),t.qZA()()}if(2&n){const e=o.$implicit;t.xp6(2),t.Oqu(e.name+" "+e.last_name)}}function Ft(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"app-appointment-offer",12),t.NdJ("selectedDate",function(s){t.CHM(e);const a=t.oxw();return t.KtG(a.receiveSelectedDate(s))}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("disponibilities",e.specialistDailyDisponibilities)("appointments",e.specialistAppointments)}}const Jt=[{path:"",children:[{path:"panel",component:rt},{path:"new",component:(()=>{class n{constructor(e,i,s,a){this.appointments=e,this.disponibilities=i,this.auth=s,this.profileService=a,this.mms=new y(0,90),this.currentProfile=new h.N,this.patientProfiles=[],this.newAppointment=new u,this.dateManager=new Date,this.specialistAppointments=[],this.specialistDailyDisponibilities=[],this.specialistFullName=""}ngOnInit(){if(this.currentProfile=this.auth.GetCurrentUserProfile(),0==this.currentProfile.role){this.move();let e=this.auth.GetCurrentUserID();e&&(this.newAppointment.idPatient=e)}else 2==this.currentProfile.role&&this.profileService.getPatientProfiles().pipe((0,_.P)()).subscribe(e=>this.patientProfiles=e)}receiveSpecialityAndSpecialist(e){this.newAppointment.idSpecialist=e.specialist.uid,this.newAppointment.speciality=e.speciality,this.specialistFullName=e.specialist.name+" "+e.specialist.last_name,this.appointments.getAppointmentsBySpecialistId(this.newAppointment.idSpecialist).subscribe(i=>this.specialistAppointments=i),this.disponibilities.getDisponibilitiesByUID(this.newAppointment.idSpecialist).subscribe(i=>{const s=new mt.l(i[0].specialistId,i[0].disponibilities).getDisponibilities();for(let a=0;a<s.length;a++){let c=new lt.w(s[a].specialityName,s[a].dailyDisponibilities);c.getSpecialityName().toLowerCase()==this.newAppointment.speciality.toLowerCase()&&(this.specialistDailyDisponibilities=c.getDailyDisponibilities(),this.move())}})}receiveSelectedDate(e){this.newAppointment.timestamp=e.getTime().toString(),this.newAppointment.duration=30,this.move()}move(e=1,i="f"){if("b"==i)for(let s=0;s<e;s++)this.moveLeft();else for(let s=0;s<e;s++)this.moveRight()}moveRight(){this.mms=new y(this.mms.elementOnScreen+1,90)}moveLeft(){this.mms=new y(this.mms.elementOnScreen-1,90)}receiveCancelation(){this.move(0==this.currentProfile.role?2:3,"b")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(w.H),t.Y36(ut.V),t.Y36(p.e),t.Y36(A.H))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-appointment"]],decls:17,vars:8,consts:[[1,"panel-container"],["id","title"],["id","mms-container"],[1,"mss",3,"mms"],[1,"mss-content"],[1,"row","mt-5"],["class","alert alert-success col-3 me-2 patient-card",3,"click",4,"ngFor","ngForOf"],[3,"specialityAndSpecialist"],[3,"disponibilities","appointments","selectedDate",4,"ngIf"],[3,"appointment","specialistFullName","onCancelation"],[1,"alert","alert-success","col-3","me-2","patient-card",3,"click"],[2,"font-weight","bold"],[3,"disponibilities","appointments","selectedDate"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Solicitar Turno"),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),t.YNc(7,It,3,1,"div",6),t.qZA()()(),t.TgZ(8,"div",3)(9,"div",4)(10,"app-create-appointment-first-step",7),t.NdJ("specialityAndSpecialist",function(a){return i.receiveSpecialityAndSpecialist(a)}),t.qZA()()(),t.TgZ(11,"div",3)(12,"div",4),t.YNc(13,Ft,1,2,"app-appointment-offer",8),t.qZA()(),t.TgZ(14,"div",3)(15,"div",4)(16,"app-appointment-confirmation",9),t.NdJ("onCancelation",function(){return i.receiveCancelation()}),t.qZA()()()()()),2&e&&(t.xp6(4),t.Q6J("mms",i.mms),t.xp6(3),t.Q6J("ngForOf",i.patientProfiles),t.xp6(1),t.Q6J("mms",i.mms),t.xp6(3),t.Q6J("mms",i.mms),t.xp6(2),t.Q6J("ngIf",2==i.mms.elementOnScreen),t.xp6(1),t.Q6J("mms",i.mms),t.xp6(2),t.Q6J("appointment",i.newAppointment)("specialistFullName",i.specialistFullName))},dependencies:[f.sg,f.O5,dt,yt,kt,Nt],styles:[".panel-container[_ngcontent-%COMP%]{width:95vw;border:var(--dark) solid 1px;margin-top:1rem;border-radius:1rem;margin:2rem auto}#title[_ngcontent-%COMP%]{margin-top:1rem;margin-left:1rem}#mms-container[_ngcontent-%COMP%]{width:90vw;margin:2.5vw;display:flex;overflow:hidden;padding:0}.mss[_ngcontent-%COMP%]{width:100%;transition:all 1s ease-in-out}.mss-content[_ngcontent-%COMP%]{width:70vw;margin-right:10vw;margin-left:10vw;padding:0}.patient-card[_ngcontent-%COMP%]:hover{cursor:pointer}.patient-card[_ngcontent-%COMP%]:active{transform:scale(.95)}"]}),n})()}]}];let Bt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[C.Bz.forChild(Jt),C.Bz]}),n})(),Ut=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[f.ez,Bt]}),n})()},349:(x,v,r)=>{r.d(v,{H:()=>_});var f=r(4650),C=r(7407);let _=(()=>{class u{constructor(t){this.firestore=t,this.collectionPath="/appointments",this.apponintmentsCollection=t.collection(this.collectionPath)}getDocuments(){return this.apponintmentsCollection.valueChanges({idField:"id"})}addDocument(t){return this.apponintmentsCollection.add(t)}updateDocument(t,p){return this.apponintmentsCollection.doc(t).update(p)}deleteDocument(t){return this.apponintmentsCollection.doc(t).delete()}getAppointmentsBySpecialistId(t){return this.firestore.collection(this.collectionPath,p=>p.where("idSpecialist","==",t)).valueChanges({idField:"id"})}getAppointmentsByPatientId(t){return this.firestore.collection(this.collectionPath,p=>p.where("idPatient","==",t)).valueChanges({idField:"id"})}getAppointmentsByStatus(t){return this.firestore.collection(this.collectionPath,p=>p.where("status","==",t)).valueChanges({idField:"id"})}}return u.\u0275fac=function(t){return new(t||u)(f.LFG(C.ST))},u.\u0275prov=f.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},2963:(x,v,r)=>{r.d(v,{R:()=>C});var f=r(4650);let C=(()=>{class _{constructor(){}getInvertedLocaleDateStringByTimestamp(h){let t=new Date(Number(h)).toLocaleDateString(),p=t.split("/");return 1==p[1].length&&(p[1]="0"+p[1]),1==p[0].length&&(p[0]="0"+p[0]),3==p.length?p[2]+"-"+p[1]+"-"+p[0]:t}getLocaleDateStringByTimestamp(h){return new Date(Number(h)).toLocaleDateString()}getLocaleTimeStringByTimestamp(h){const t=new Date(Number(h));return t.getHours().toString()+":"+(1==t.getMinutes().toString().length?"0"+t.getMinutes().toString():t.getMinutes().toString())}getDayOfTheWeekNameByTimestamp(h){let p="";switch(new Date(Number(h)).getDay()){case 1:p="Lunes";break;case 2:p="Martes";break;case 3:p="Mi\xe9rcoles";break;case 4:p="Jueves";break;case 5:p="Viernes";break;case 6:p="S\xe1bado";break;case 0:p="Domingo"}return p}}return _.\u0275fac=function(h){return new(h||_)},_.\u0275prov=f.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()}}]);