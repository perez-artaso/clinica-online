<div [formGroup]="this.newUserForm" id="new-patient-form">
    <div class="row">

        <div class="border border-dark rounded form-section">

            <h3 class="pl-3 pt-3 pb-0">Información General</h3>

            <div class="row p-3 pt-0">

                <div class="col-6">
                    <div class="form-group">
                        <label for="first-name">Nombre</label>
                        <input [ngClass]="{'is-invalid': this.newUserForm.get('name')?.invalid && this.newUserForm.get('name')?.touched && this.allHasBeenTouched() }" formControlName="name" class="form-control" type="text" name="first-name" id="first-name">
                    </div>
                </div>

                <div class="col-6">
                    <div class="form-group">
                        <label for="last-name">Apellido</label>
                        <input [ngClass]="{'is-invalid': this.newUserForm.get('last_name')?.invalid && this.newUserForm.get('last_name')?.touched && this.allHasBeenTouched() }" formControlName="last_name" class="form-control" type="text" name="last-name" id="last-name">
                    </div>
                </div>

                <div class="col-6">
                    <div class="form-group">
                        <label for="age">Edad</label>
                        <input [ngClass]="{'is-invalid': this.newUserForm.get('age')?.invalid && this.newUserForm.get('age')?.touched && this.allHasBeenTouched() }" formControlName="age" class="form-control" type="number" name="age" id="age">
                    </div>
                </div>

                <div class="col-6">
                    <div class="form-group">
                        <label for="id-number">DNI</label>
                        <input [ngClass]="{'is-invalid': this.newUserForm.get('id_number')?.invalid && this.newUserForm.get('id_number')?.touched && this.allHasBeenTouched() }" formControlName="id_number" class="form-control" type="text" name="id-number" id="id-number">
                    </div>
                </div>

            </div>

        </div>

        <div class="border border-dark mt-3 rounded form-section">
            <h3 class="pl-3 pt-3 pb-0">Especialidad</h3>

            <div class="row p-3 pt-0">

                <div class="col-8">
                    <div class="form-group">
                        <input [ngClass]="{'is-invalid': this.newUserForm.get('speciality')?.invalid && this.newUserForm.get('speciality')?.touched && this.allHasBeenTouched() }" formControlName="speciality" type="text" class="form-control" name="speciality" id="speciality">
                    </div>
    
                </div>
                
                <div class="col-4">
                    <button id="add-speciality" class="btn btn-lg btn-block btn-info form-control" (click)="this.addSpeciality()">+</button>
                </div>

            </div>

        </div>

        

        <div class="border border-dark rounded mt-3 form-section">

            <h3 class="pl-3 pt-3 pb-0">Imagen de Perfil</h3>

            <div class="row p-3 pt-0">

                <div class="col-12">

                    <div class="input-group">
                        <input [ngClass]="{'is-invalid': this.newUserForm.get('first_profile_image')?.invalid && this.newUserForm.get('first_profile_image')?.touched && this.allHasBeenTouched() }" type="file" class="form-control" id="first-profile-image" (change)="this.firstImageSubmitted($event)">
                    </div>
    
                </div>

            </div>
        </div>

        <div class="mt-3 mx-auto border border-dark rounded form-section">

            <h3 class="pl-3 pt-3 pb-0">Credenciales</h3>

            <div class="row p-3 pt-0">

                <div class="col-12">
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input [ngClass]="{'is-invalid': this.newUserForm.get('email')?.invalid && this.newUserForm.get('email')?.touched && this.allHasBeenTouched() }" formControlName="email" class="form-control" type="text" name="email" id="email">
                    </div>
                </div>
                <div class="col-12 my-2">
                    <div class="form-group">
                        <label for="password">Contraseña</label>
                        <input [ngClass]="{'is-invalid': this.newUserForm.get('password')?.invalid && this.newUserForm.get('password')?.touched && this.allHasBeenTouched() }" formControlName="password" class="form-control" type="password" name="password" id="password">
                    </div>
                </div>
                <div class="col-12 my-2">
                    <div class="form-group">
                        <label for="password-control">Confirmación de contraseña</label>
                        <input [ngClass]="{'is-invalid': this.newUserForm.get('password_control')?.invalid && this.newUserForm.get('password_control')?.touched && this.allHasBeenTouched() }" formControlName="password_control" class="form-control" type="password" name="password-control" id="password-control">
                    </div>
                </div>

            </div>

        </div>

    </div>

    <div class="row mt-3">
        <button class="btn lg-form-btn" (click)="submit()">Enviar</button>
        <button class="btn lg-form-btn exit mt-2" (click)="this.exit()">Salir</button>
    </div>

    <div *ngIf="this.newUserForm.invalid && this.newUserForm.touched && this.allHasBeenTouched() || this.passwordsDontMatch && this.allHasBeenTouched()" class="alert alert-danger mt-3">
        <div *ngIf="this.newUserForm.get('name')?.touched && newUserForm.get('name')?.hasError('required')">El nombre es requerido</div>
        <div *ngIf="this.newUserForm.get('last_name')?.touched && newUserForm.get('last_name')?.hasError('required')">El apellido es requerido</div>
        <div *ngIf="this.newUserForm.get('age')?.touched && newUserForm.get('age')?.hasError('required')">La edad es requerida</div>
        <div *ngIf="this.newUserForm.get('age')?.touched && newUserForm.get('age')?.hasError('min')">La no puede ser menor a 1 (uno)</div>
        <div *ngIf="this.newUserForm.get('age')?.touched && newUserForm.get('age')?.hasError('max')">La edad no puede ser mayor a 120</div>
        <div *ngIf="this.newUserForm.get('age')?.touched && newUserForm.get('age')?.hasError('pattern')">La edad debe ser expresada en números únicamente</div>
        <div *ngIf="this.newUserForm.get('id_number')?.touched && newUserForm.get('id_number')?.hasError('required')">El DNI es requerido</div>
        <div *ngIf="this.newUserForm.get('id_number')?.touched && newUserForm.get('id_number')?.hasError('pattern')">El DNI debe contener sólo números y puntos (ej. 12.345.678)</div>
        <div *ngIf="this.newUserForm.get('speciality')?.touched && newUserForm.get('speciality')?.hasError('required')">La especialidad es requerida</div>
        <div *ngIf="this.newUserForm.get('first_profile_image')?.touched && newUserForm.get('first_profile_image')?.hasError('required')">La imagen de perfil es requerida</div>
        <div *ngIf="this.newUserForm.get('email')?.touched && newUserForm.get('email')?.hasError('required')">El email es requerido</div>
        <div *ngIf="this.newUserForm.get('email')?.touched && newUserForm.get('email')?.hasError('pattern')">Formato de mail incorrecto</div>
        <div *ngIf="this.newUserForm.get('password')?.touched && newUserForm.get('password')?.hasError('required')">La contraseña es requerida</div>
        <div *ngIf="this.newUserForm.get('password')?.touched && newUserForm.get('password')?.hasError('minlength')">La extensión mínima para la contraseña es de 6 caracteres</div>
        <div *ngIf="this.passwordsDontMatch">Las contraseñas no coinciden</div>
    </div>

    <app-specialities-selection *ngIf="this.showSpecialities" (speciality)="this.receiveSpeciality($event)"></app-specialities-selection>

</div>